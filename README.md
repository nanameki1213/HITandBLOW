# HITandBLOW

C言語でヒットアンドブローを作成する手順を以下に示します。
これまでのC言語の知識を使いながら、足りない部分は補完します。
説明が下手なので理解できないところがあったら調べたり、聞いたりしてください。

## 完成したゲームを遊んでみる

作り始める前に、ゲームをやってみよう
1. このページの右上、緑色のCodeという部分を押す
2. Download ZIP を選択
3. ZIPをHOME(x:)に展開
4. フォルダ内のhitandblow_with_function.cをCpadで開き、実行

## ゲームを実装するために何が必要か考えてみる

まず設計から考える
prototype.cを開くと、ゲームのプロトタイプ(原形)が書かれているので、これを参考に完成させる。
1.から5.までを順番に実装していき、最後につなげて完成させる。

### プロトタイプの説明

prototype.c内の、1.から5.までをひとつづつ完成させていきます。
コードを書く前に、既に書かれている部分の説明を行います。

#### 変数の説明

このゲームを作るうえで、どのような変数が必要になってくるでしょうか
プロトタイプのコードで、既に変数宣言を行っているので、その解説をしていきたいと思います。
```prototype.c
int main(void) {
  int ans[DIGITS_NUM];
  int i, j;
  int hit_num = 0, blow_num = 0;
```
main関数内の初めの2行は、変数宣言が行われています。正解の3桁を格納するansという名前のint型配列と、繰返しのインデックスとして後々使うiとjを宣言しています。DIGITS_NUMについては後述します。さらに、hit_num, blow_numはそれぞれヒット数、ブロー数を格納するために用意しています。hit_num, blow_numについては、後にカウントを行うため、0で初期化しています。
```prototype.c
while(/* プレイヤーが正解しない間 */) {
    int input[DIGITS_NUM];
    int input;
```
ゲームの進行部分にあたるループの中でも、変数宣言が行われています。プレイヤーから入力された3桁の数字を格納するint型変数inputと、inputの各桁の数字を格納するための3つの要素を持つint型の配列input_arrayを宣言しています。この二つの使い分けについては後述します。

ここまでの変数をまとめると、以下の様になります。
| 変数名 | 役割 |
| ---- | ---- |
| ans | 正解を格納 |
| input | プレイヤーの回答を格納 | 
| input_array | inputの各桁の数字を格納 |
| i | 繰り返しのインデックスとして使用 |
| j | 繰り返しのインデックスとして使用 |
| hit_num | ヒット数を格納 |
| blow_num | ブロー数を格納 |

#### プリプロセス部分の説明
```prototype.c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#define DIGITS_NUM 3
```
このコードの始めには、いつもの定型文である#include <stdio.h>に加えて、いろいろなものが書いてあります。特徴は、すべて文頭に#がついていることです。C言語では文頭に#がつく文は特別で、普通のC言語の文(printfなど)がコンパイラによって処理されるのに対して、#がつく文はプリプロセッサと呼ばれるものに処理されます。英語で接頭辞プリ(pre)は、前という意味があります。つまり、プリプロセッサとは、コンパイラによる処理の前に行われる処理、ということになります。ここでは#includeと#defineのみ簡単に説明します。
##### #include
#include は、指定されたファイルを読み込みます。例えば#include <stdio.h>では、stdio.hというファイルをどこかから引っ張ってきて、このファイルに展開しているということです。stdio.hにはいったい何が入っているのでしょうか。いつも使っているprintfやscanfなどです。stdio、とは、standard input/outputを略したファイル名で、その名の通り、基本的な入出力の関数たちを格納しています。stdio.hを#includeで読み込むことで、printやscanfを読み込んでいることになります。逆に言えば、これをincludeしないと、それらの関数は使えないということです。C言語単体では、画面表示の機能まではサポートしていません。今回のプログラムでは事情によりstdio.hだけでなくstdlib.h、time.hもincludeしています。

##### #define
今回のプログラムで本当に大事なのはこっちです。#defineとは、マクロ機能などとも呼ばれ、プログラム中の文字列をあらかじめ定義した規則にしたがって置換する機能です。定数として考えると手っ取り早く理解できると思います。マクロ機能があるとなぜいいのかをストーリーで示します。
```prototype.c
#include <stdio.h>

int main(void) {
  int ans[3];
  return 0;
}
```
このプログラムは、要素数3のint型配列を宣言します。この3という数字は桁数を表しているのです。しかしこの説明なしにいきなりプログラムを見せられると、この3という数字が何を意味しているのかわかりません。マクロ機能を使って同じことをするプログラムを次に示します。
```prototype.c
#include <stdio.h>
#define DIGITS_NUM 3

int main(void) {
  int ans[DIGITS_NUM];
  return 0;
}
```
DIGITS_NUMというマクロを追加して、配列の宣言に用いています。DIGITS_NUMとは、翻訳すると桁数です。これにより、プログラムが幾分みやすくなりました。

## ゲームの実装

ここからプログラムを作成していきます。実装するときに気にかけてほしい事は、できるだけ汎用性を保つことです。具体的に言うと、いまゲームの数字の桁数は3桁ですが、難易度を求めて4桁、5桁の数字を当てたいと思ったとき、DIGITS_NUMの3という数字を4、5に変えるだけで他は何も変えなくてもいいという状態を目指してください。

### 答えとなる数を設定する

ここからゲームの実装に入っていきます。まずは「1.答えとなる数を設定する」です。このゲームの答えはランダムで設定されるようになっています。しかし、いきなりランダムな答えを生成するコードを書くのは難しいので、とりあえず最初は何回遊んでも答えが毎回同じという仕様にしましょう。このようにゲームの実装は、最低限ゲームが完成するところまでもっていき、それから答えをランダムにするなどの機能を追加で実装していくことにします。さて、答えはansというint型配列に格納されるのでした。ansの各要素に数を代入してあげれば、答えを設定できそうです。しかし、ヒットアンドブローというゲームの性質上、答えとなる数の各桁の数は重複が許されないのでした。例えば121とか334のような数は答えに設定しないようにします。

### プレイヤーからの数の入力を行う

プレイヤーからの入力を行います。答えを設定した時と同様に、プレイヤーからの入力も重複があってはなりません。実装はを簡潔にするため、重複を検知する機能を実装するのは後からにして、とりあえず最初はプレイヤーがミスをしないことを祈ることにしましょう。プレイヤーからの入力は2段階で行われます。
1. 3桁の数字をscanfでinputに入力
2. inputから配列input_arrayに変換

1.は普通に数をscanfで読み取ってください。3桁以上の数や3桁未満の数を入力された場合の事は今は考えなくていいです。プレイヤーに任せましょう。
2.が難関になると思います。3桁の数字の各桁をどうにか得て、input_arrayに順になるように格納してください。たとえばinputが123のとき、input_arrya[0]は1、input_arrya[1]は2、input_arrya[2]は3になるようにしてください。

### 入力された数のヒット数を計算

プレイヤーからの入力と正解を照らし合わせてヒット数を算出します。ヒットとは、数も場所もあっている状態の数でした。つまり、for文で正解と回答の二つの配列を走査して、一致している数だけカウントすれば良さそうですね。

### 入力された数のブロー数を計算

同様に、ブロー数を計算します。ブロー数は、数は一致しているが、場所が一致していないような数です。そのため、ヒット数より計算が複雑になります。ヒントは2重ループを使います。

### 結果を表示

正解しているかどうかを判定し、正解していれば正解!と出力、不正解ならヒット数、ブロー数を表す変数をprintfで出力します。正解かどうかを判断するにはどうすればいいでしょうか。正解している時のヒット数とブロー数の状態を考えてみましょう。正解しているということは、全ヒットということなので、ヒット数と桁数が一致している状態が、正解の時ということになります。

## ゲームの実装(答え)
